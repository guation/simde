/* SPDX-License-Identifier: MIT
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
 * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 * Copyright:
 *   2020      Evan Nemerson <evan@nemerson.com>
 *   2020      Hidayat Khan <huk2209@gmail.com>
 *   2024      Guation <guation@guation.cn>
 */

#define SIMDE_TEST_X86_AVX512_INSN mulhi

#include <test/x86/avx512/test-avx512.h>
#include <simde/x86/avx512/mulhi.h>

static int
test_simde_mm512_mulhi_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const int16_t a[32];
    const int16_t b[32];
    const int16_t r[32];
  } test_vec[] = {
    { { -INT16_C( 16752),  INT16_C(  3096),  INT16_C( 21789),  INT16_C( 27232), -INT16_C( 17038),  INT16_C( 13798), -INT16_C(  6599), -INT16_C( 28056),
        -INT16_C( 14632),  INT16_C( 22925), -INT16_C( 11459),  INT16_C( 11763),  INT16_C( 13417),  INT16_C( 15127),  INT16_C(  4707), -INT16_C(  3144),
        -INT16_C( 12079), -INT16_C(  4353),  INT16_C( 24613), -INT16_C( 26792),  INT16_C( 15901),  INT16_C( 22476),  INT16_C( 13349), -INT16_C(   535),
         INT16_C( 30459),  INT16_C( 14422),  INT16_C( 18761), -INT16_C( 19867),  INT16_C( 31870), -INT16_C(  7698), -INT16_C( 22898),  INT16_C( 24533) },
      { -INT16_C( 11145), -INT16_C( 25523), -INT16_C( 22988),  INT16_C( 21044),  INT16_C(   228),  INT16_C(  2473), -INT16_C( 28107),  INT16_C( 12294),
         INT16_C( 23560),  INT16_C( 20840), -INT16_C( 12890),  INT16_C(  9220), -INT16_C(  3511), -INT16_C( 10491), -INT16_C(  9576),  INT16_C(  3895),
        -INT16_C( 31569), -INT16_C(  7252), -INT16_C(  8150),  INT16_C(  3893), -INT16_C(  8480),  INT16_C(  5400),  INT16_C(  8048),  INT16_C( 30789),
        -INT16_C( 21125),  INT16_C(  8650), -INT16_C( 12678), -INT16_C( 15547),  INT16_C( 19392),  INT16_C( 22683), -INT16_C( 11739), -INT16_C( 11160) },
      {  INT16_C(  2848), -INT16_C(  1206), -INT16_C(  7643),  INT16_C(  8744), -INT16_C(    60),  INT16_C(   520),  INT16_C(  2830), -INT16_C(  5264),
        -INT16_C(  5261),  INT16_C(  7289),  INT16_C(  2253),  INT16_C(  1654), -INT16_C(   719), -INT16_C(  2422), -INT16_C(   688), -INT16_C(   187),
         INT16_C(  5818),  INT16_C(   481), -INT16_C(  3061), -INT16_C(  1592), -INT16_C(  2058),  INT16_C(  1851),  INT16_C(  1639), -INT16_C(   252),
        -INT16_C(  9819),  INT16_C(  1903), -INT16_C(  3630),  INT16_C(  4713),  INT16_C(  9430), -INT16_C(  2665),  INT16_C(  4101), -INT16_C(  4178) } },
    { {  INT16_C(  5206), -INT16_C( 32328), -INT16_C(  4620), -INT16_C( 11120), -INT16_C( 22324),  INT16_C( 15594),  INT16_C( 12231),  INT16_C( 17333),
         INT16_C( 32733),  INT16_C( 22372), -INT16_C( 21939),  INT16_C(  3355), -INT16_C( 18699),  INT16_C(  6757), -INT16_C( 12920), -INT16_C(  8465),
        -INT16_C( 22559), -INT16_C( 10913), -INT16_C(  4204),  INT16_C( 24746), -INT16_C( 27496),  INT16_C( 24477),  INT16_C( 21187), -INT16_C( 24414),
         INT16_C(  2001),  INT16_C(  7928),  INT16_C(  5041), -INT16_C( 22997), -INT16_C( 28471),  INT16_C( 20928), -INT16_C( 20642),  INT16_C( 16175) },
      { -INT16_C( 28842), -INT16_C(  5355), -INT16_C( 16514),  INT16_C(  5707), -INT16_C(  6061),  INT16_C(  5750),  INT16_C(  6202),  INT16_C(  2999),
        -INT16_C( 20705), -INT16_C( 12247),  INT16_C( 21698), -INT16_C( 29834),  INT16_C( 14309),  INT16_C( 17372),  INT16_C(  3046),  INT16_C( 15746),
        -INT16_C( 26726),  INT16_C(  6440),  INT16_C( 29526), -INT16_C( 22225), -INT16_C( 23204), -INT16_C( 26944),  INT16_C( 30654), -INT16_C(  8798),
        -INT16_C( 13530), -INT16_C(  5970),  INT16_C(  9248),  INT16_C(  1395),  INT16_C( 20315),  INT16_C( 16968), -INT16_C( 13734), -INT16_C(  2689) },
      { -INT16_C(  2292),  INT16_C(  2641),  INT16_C(  1164), -INT16_C(   969),  INT16_C(  2064),  INT16_C(  1368),  INT16_C(  1157),  INT16_C(   793),
        -INT16_C( 10342), -INT16_C(  4181), -INT16_C(  7264), -INT16_C(  1528), -INT16_C(  4083),  INT16_C(  1791), -INT16_C(   601), -INT16_C(  2034),
         INT16_C(  9199), -INT16_C(  1073), -INT16_C(  1895), -INT16_C(  8393),  INT16_C(  9735), -INT16_C( 10064),  INT16_C(  9910),  INT16_C(  3277),
        -INT16_C(   414), -INT16_C(   723),  INT16_C(   711), -INT16_C(   490), -INT16_C(  8826),  INT16_C(  5418),  INT16_C(  4325), -INT16_C(   664) } },
    { { -INT16_C( 22686), -INT16_C( 18418),  INT16_C( 15642),  INT16_C( 30306),  INT16_C(  8931), -INT16_C( 24307), -INT16_C( 20583), -INT16_C( 16514),
         INT16_C( 11386), -INT16_C( 25945),  INT16_C(  6737), -INT16_C( 21345), -INT16_C(  6295), -INT16_C( 15378),  INT16_C( 28082),  INT16_C(  5304),
        -INT16_C( 14828),  INT16_C( 12236),  INT16_C( 11780), -INT16_C(  6235), -INT16_C( 19888), -INT16_C(  5752),  INT16_C(  1633), -INT16_C(  9048),
         INT16_C( 20275), -INT16_C( 31626),  INT16_C(  5737), -INT16_C( 11728),  INT16_C(  8189), -INT16_C( 20586),  INT16_C( 20108), -INT16_C( 24125) },
      { -INT16_C( 28651),  INT16_C(  6608),  INT16_C( 30142),  INT16_C(  3840), -INT16_C( 30680), -INT16_C( 30216), -INT16_C( 24178), -INT16_C( 16027),
        -INT16_C(  8976),  INT16_C( 23109),  INT16_C( 30450), -INT16_C(  4308), -INT16_C( 15723),  INT16_C(  8607),  INT16_C( 25105),  INT16_C(  9922),
        -INT16_C( 27918), -INT16_C( 20161),  INT16_C( 16136),  INT16_C( 12480), -INT16_C( 18233),  INT16_C( 21945),  INT16_C(  8025),  INT16_C( 18967),
         INT16_C( 23803), -INT16_C(  4700), -INT16_C( 12078),  INT16_C( 26588),  INT16_C( 31635), -INT16_C( 23415),  INT16_C( 19422), -INT16_C( 12086) },
      {  INT16_C(  9917), -INT16_C(  1858),  INT16_C(  7194),  INT16_C(  1775), -INT16_C(  4181),  INT16_C( 11206),  INT16_C(  7593),  INT16_C(  4038),
        -INT16_C(  1560), -INT16_C(  9149),  INT16_C(  3130),  INT16_C(  1403),  INT16_C(  1510), -INT16_C(  2020),  INT16_C( 10757),  INT16_C(   803),
         INT16_C(  6316), -INT16_C(  3765),  INT16_C(  2900), -INT16_C(  1188),  INT16_C(  5533), -INT16_C(  1927),  INT16_C(   199), -INT16_C(  2619),
         INT16_C(  7363),  INT16_C(  2268), -INT16_C(  1058), -INT16_C(  4759),  INT16_C(  3952),  INT16_C(  7355),  INT16_C(  5959),  INT16_C(  4449) } },
    { {  INT16_C(  2526), -INT16_C(  6527),  INT16_C( 16712),  INT16_C(  3862), -INT16_C( 12294),  INT16_C( 21348),  INT16_C( 31726), -INT16_C(  5731),
         INT16_C( 16856), -INT16_C( 21802), -INT16_C( 19694), -INT16_C( 23278), -INT16_C( 25810),  INT16_C(  3145),  INT16_C(  5094), -INT16_C( 15139),
         INT16_C( 24092),  INT16_C( 25770), -INT16_C( 16224), -INT16_C( 25997), -INT16_C( 10352),  INT16_C( 32493), -INT16_C( 29869),  INT16_C( 11112),
         INT16_C( 16076), -INT16_C(  8491), -INT16_C(  6159),  INT16_C(  8323), -INT16_C( 13182),  INT16_C( 26924),  INT16_C(  2527), -INT16_C(  1235) },
      { -INT16_C( 10136),  INT16_C(  2143), -INT16_C( 11624),  INT16_C( 10402), -INT16_C( 28758), -INT16_C(   601),  INT16_C(  3866), -INT16_C(  6360),
        -INT16_C(   691),  INT16_C( 16325),  INT16_C( 18917),  INT16_C( 26463), -INT16_C( 29931), -INT16_C(  2608), -INT16_C(   363), -INT16_C(   528),
         INT16_C( 20694),  INT16_C( 28165), -INT16_C( 22750), -INT16_C( 13161),  INT16_C( 15926),  INT16_C( 20937), -INT16_C(  3763), -INT16_C( 26056),
        -INT16_C(   529), -INT16_C( 11047),  INT16_C( 14406),  INT16_C( 23611),  INT16_C(  3268),  INT16_C( 22865),  INT16_C( 16650), -INT16_C(  8106) },
      { -INT16_C(   391), -INT16_C(   214), -INT16_C(  2965),  INT16_C(   612),  INT16_C(  5394), -INT16_C(   196),  INT16_C(  1871),  INT16_C(   556),
        -INT16_C(   178), -INT16_C(  5431), -INT16_C(  5685), -INT16_C(  9400),  INT16_C( 11787), -INT16_C(   126), -INT16_C(    29),  INT16_C(   121),
         INT16_C(  7607),  INT16_C( 11075),  INT16_C(  5631),  INT16_C(  5220), -INT16_C(  2516),  INT16_C( 10380),  INT16_C(  1715), -INT16_C(  4418),
        -INT16_C(   130),  INT16_C(  1431), -INT16_C(  1354),  INT16_C(  2998), -INT16_C(   658),  INT16_C(  9393),  INT16_C(   642),  INT16_C(   152) } },
    { {  INT16_C( 23441), -INT16_C( 19378), -INT16_C(  6910),  INT16_C( 14464),  INT16_C( 18979),  INT16_C( 28809), -INT16_C( 16069),  INT16_C( 10763),
        -INT16_C(  6977),  INT16_C(  1534),  INT16_C( 14877), -INT16_C(  7839), -INT16_C( 19898),  INT16_C( 20538), -INT16_C( 28428), -INT16_C( 31440),
         INT16_C( 32491), -INT16_C(  4807), -INT16_C( 17820), -INT16_C( 30939), -INT16_C( 20732),  INT16_C( 16376),  INT16_C(   880),  INT16_C( 12138),
         INT16_C( 26855),  INT16_C(  1077), -INT16_C( 26974), -INT16_C(  5915),  INT16_C(  8009),  INT16_C( 15672),  INT16_C( 26799), -INT16_C( 25918) },
      { -INT16_C(   793),  INT16_C( 19335), -INT16_C( 21066), -INT16_C( 17710), -INT16_C( 13732), -INT16_C( 13063),  INT16_C( 25549), -INT16_C( 18948),
         INT16_C( 12748),  INT16_C( 28345), -INT16_C( 24633),  INT16_C(  4183), -INT16_C( 28738),  INT16_C( 28237),  INT16_C(  4344), -INT16_C(  8440),
        -INT16_C( 28660), -INT16_C( 15830), -INT16_C(   963), -INT16_C( 26244),  INT16_C( 30151), -INT16_C( 27547),  INT16_C( 25049), -INT16_C( 23223),
         INT16_C(   914),  INT16_C( 23059),  INT16_C( 27298),  INT16_C( 24682), -INT16_C( 18182), -INT16_C(  3378), -INT16_C( 10296), -INT16_C( 11055) },
      { -INT16_C(   284), -INT16_C(  5718),  INT16_C(  2221), -INT16_C(  3909), -INT16_C(  3977), -INT16_C(  5743), -INT16_C(  6265), -INT16_C(  3112),
        -INT16_C(  1358),  INT16_C(   663), -INT16_C(  5592), -INT16_C(   501),  INT16_C(  8725),  INT16_C(  8849), -INT16_C(  1885),  INT16_C(  4048),
        -INT16_C( 14209),  INT16_C(  1161),  INT16_C(   261),  INT16_C( 12389), -INT16_C(  9539), -INT16_C(  6884),  INT16_C(   336), -INT16_C(  4302),
         INT16_C(   374),  INT16_C(   378), -INT16_C( 11236), -INT16_C(  2228), -INT16_C(  2222), -INT16_C(   808), -INT16_C(  4211),  INT16_C(  4372) } },
    { { -INT16_C(  1177), -INT16_C( 23402),  INT16_C(  4855), -INT16_C( 16835), -INT16_C( 23929),  INT16_C( 24659), -INT16_C( 25596), -INT16_C( 27131),
         INT16_C(  6559),  INT16_C( 16880),  INT16_C( 23427),  INT16_C( 32162),  INT16_C( 28691), -INT16_C(  9361),  INT16_C( 16455), -INT16_C( 20817),
         INT16_C( 17723),  INT16_C( 13138), -INT16_C( 28841), -INT16_C(  8463),  INT16_C( 17458),  INT16_C( 13887),  INT16_C( 17633), -INT16_C( 32564),
        -INT16_C( 17059), -INT16_C(  7742),  INT16_C( 25624),  INT16_C( 11102), -INT16_C( 12588),  INT16_C(  7174), -INT16_C( 19186),  INT16_C( 19146) },
      {  INT16_C(  7674),  INT16_C( 20861),  INT16_C( 28332), -INT16_C(  8657),  INT16_C( 28339), -INT16_C( 27628), -INT16_C(  7757),  INT16_C(  4116),
        -INT16_C( 10594), -INT16_C( 18703),  INT16_C( 20538),  INT16_C(  4065), -INT16_C(  6370),  INT16_C( 11307), -INT16_C(  2660), -INT16_C( 27018),
        -INT16_C(  3310), -INT16_C( 16409),  INT16_C(  5730),  INT16_C(  5533), -INT16_C( 19835),  INT16_C( 14505), -INT16_C( 17005),  INT16_C( 12616),
         INT16_C( 14996), -INT16_C( 12569), -INT16_C( 14198), -INT16_C( 22307),  INT16_C(  2223),  INT16_C( 19412),  INT16_C( 19454),  INT16_C(  4321) },
      { -INT16_C(   138), -INT16_C(  7450),  INT16_C(  2098),  INT16_C(  2223), -INT16_C( 10348), -INT16_C( 10396),  INT16_C(  3029), -INT16_C(  1704),
        -INT16_C(  1061), -INT16_C(  4818),  INT16_C(  7341),  INT16_C(  1994), -INT16_C(  2789), -INT16_C(  1616), -INT16_C(   668),  INT16_C(  8582),
        -INT16_C(   896), -INT16_C(  3290), -INT16_C(  2522), -INT16_C(   715), -INT16_C(  5284),  INT16_C(  3073), -INT16_C(  4576), -INT16_C(  6269),
        -INT16_C(  3904),  INT16_C(  1484), -INT16_C(  5552), -INT16_C(  3779), -INT16_C(   427),  INT16_C(  2124), -INT16_C(  5696),  INT16_C(  1262) } },
    { { -INT16_C( 14274), -INT16_C( 24369),  INT16_C( 28126),  INT16_C( 25525),  INT16_C( 24095), -INT16_C( 19813), -INT16_C(  7140), -INT16_C( 20253),
        -INT16_C( 13794), -INT16_C( 22402),  INT16_C( 23698),  INT16_C( 16720),  INT16_C(  9316),  INT16_C( 25228),  INT16_C( 28015), -INT16_C( 20877),
         INT16_C( 16949),  INT16_C(  4942),  INT16_C(  1199), -INT16_C( 12681),  INT16_C(  4706),  INT16_C( 32384),  INT16_C( 25590),  INT16_C(  5166),
        -INT16_C( 21203), -INT16_C( 16452),  INT16_C(  3081),  INT16_C( 27904), -INT16_C( 29647), -INT16_C( 24368),  INT16_C( 17401),  INT16_C( 11854) },
      { -INT16_C( 25211),  INT16_C( 13634), -INT16_C( 18015),  INT16_C(   771), -INT16_C( 31541), -INT16_C( 15742), -INT16_C( 20249),  INT16_C(  5590),
        -INT16_C( 27811),  INT16_C( 26324), -INT16_C( 10849), -INT16_C( 12076), -INT16_C( 23455),  INT16_C( 23409), -INT16_C( 16409),  INT16_C( 27785),
        -INT16_C( 13476), -INT16_C(   607), -INT16_C( 23164),  INT16_C( 20481), -INT16_C( 31959),  INT16_C(  4114), -INT16_C(  6093), -INT16_C( 28379),
        -INT16_C(  1413),  INT16_C(  7159), -INT16_C( 13361),  INT16_C( 12523),  INT16_C( 23663),  INT16_C( 22155),  INT16_C(  5404),  INT16_C( 30915) },
      {  INT16_C(  5491), -INT16_C(  5070), -INT16_C(  7732),  INT16_C(   300), -INT16_C( 11597),  INT16_C(  4759),  INT16_C(  2206), -INT16_C(  1728),
         INT16_C(  5853), -INT16_C(  8999), -INT16_C(  3924), -INT16_C(  3081), -INT16_C(  3335),  INT16_C(  9011), -INT16_C(  7015), -INT16_C(  8852),
        -INT16_C(  3486), -INT16_C(    46), -INT16_C(   424), -INT16_C(  3964), -INT16_C(  2295),  INT16_C(  2032), -INT16_C(  2380), -INT16_C(  2238),
         INT16_C(   457), -INT16_C(  1798), -INT16_C(   629),  INT16_C(  5332), -INT16_C( 10705), -INT16_C(  8238),  INT16_C(  1434),  INT16_C(  5591) } },
    { {  INT16_C( 25824),  INT16_C( 25974),  INT16_C( 30473),  INT16_C( 12981), -INT16_C( 14342),  INT16_C( 11587),  INT16_C( 26799),  INT16_C( 11198),
        -INT16_C( 18846),  INT16_C( 12614),  INT16_C( 12673), -INT16_C(  3742), -INT16_C(  4722), -INT16_C( 21945),  INT16_C(  2562), -INT16_C(  7390),
        -INT16_C( 26513),  INT16_C( 30792), -INT16_C(   753),  INT16_C(  2475), -INT16_C(  4412),  INT16_C( 29495), -INT16_C(  2730), -INT16_C( 18018),
        -INT16_C(  6997),  INT16_C( 11754),  INT16_C( 19478), -INT16_C( 23522),  INT16_C( 25914),  INT16_C( 15438),  INT16_C( 28784), -INT16_C(  8417) },
      {  INT16_C( 26377),  INT16_C(  6231),  INT16_C(   612),  INT16_C( 10274),  INT16_C( 23024),  INT16_C( 18332),  INT16_C( 14926), -INT16_C(  1536),
        -INT16_C(  5601),  INT16_C( 13607),  INT16_C( 17719),  INT16_C( 29145),  INT16_C( 10154),  INT16_C(  6829), -INT16_C( 12905), -INT16_C( 24327),
         INT16_C( 20788), -INT16_C( 26183), -INT16_C(  9389),  INT16_C( 17601),  INT16_C( 23860), -INT16_C( 32117), -INT16_C( 29800), -INT16_C( 18564),
        -INT16_C( 23691), -INT16_C( 21268), -INT16_C( 14872), -INT16_C( 27875), -INT16_C( 13332), -INT16_C( 31827), -INT16_C( 22632), -INT16_C( 13276) },
      {  INT16_C( 10393),  INT16_C(  2469),  INT16_C(   284),  INT16_C(  2035), -INT16_C(  5039),  INT16_C(  3241),  INT16_C(  6103), -INT16_C(   263),
         INT16_C(  1610),  INT16_C(  2618),  INT16_C(  3426), -INT16_C(  1665), -INT16_C(   732), -INT16_C(  2287), -INT16_C(   505),  INT16_C(  2743),
        -INT16_C(  8410), -INT16_C( 12303),  INT16_C(   107),  INT16_C(   664), -INT16_C(  1607), -INT16_C( 14455),  INT16_C(  1241),  INT16_C(  5103),
         INT16_C(  2529), -INT16_C(  3815), -INT16_C(  4421),  INT16_C( 10004), -INT16_C(  5272), -INT16_C(  7498), -INT16_C(  9941),  INT16_C(  1705) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m512i a = simde_mm512_loadu_epi16(test_vec[i].a);
    simde__m512i b = simde_mm512_loadu_epi16(test_vec[i].b);
    simde__m512i r = simde_mm512_mulhi_epi16(a, b);
    simde_test_x86_assert_equal_i16x32(r, simde_mm512_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm512_mulhi_epu16 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t a[32];
    const uint16_t b[32];
    const uint16_t r[32];
  } test_vec[] = {
    { { UINT16_C( 8536), UINT16_C(39405), UINT16_C(63446), UINT16_C(40719), UINT16_C( 3045), UINT16_C(11723), UINT16_C(   29), UINT16_C( 8465),
        UINT16_C(45931), UINT16_C(62390), UINT16_C(35443), UINT16_C(18842), UINT16_C(42036), UINT16_C(40785), UINT16_C(63425), UINT16_C( 6637),
        UINT16_C(55832), UINT16_C(61362), UINT16_C(49617), UINT16_C(46734), UINT16_C(23244), UINT16_C(59876), UINT16_C(62810), UINT16_C(50442),
        UINT16_C(49320), UINT16_C( 7097), UINT16_C(21323), UINT16_C(32612), UINT16_C(46583), UINT16_C(47134), UINT16_C( 2988), UINT16_C(50641) },
      { UINT16_C(33766), UINT16_C(47028), UINT16_C(16965), UINT16_C( 4462), UINT16_C(21148), UINT16_C(63227), UINT16_C( 1351), UINT16_C(61372),
        UINT16_C(30150), UINT16_C( 4362), UINT16_C(28360), UINT16_C(49040), UINT16_C(44836), UINT16_C(53367), UINT16_C(18618), UINT16_C(41109),
        UINT16_C(18891), UINT16_C( 4184), UINT16_C(50828), UINT16_C(10274), UINT16_C( 7448), UINT16_C(24351), UINT16_C(56098), UINT16_C(59470),
        UINT16_C(22608), UINT16_C( 6393), UINT16_C(35526), UINT16_C(60119), UINT16_C(20025), UINT16_C(62395), UINT16_C(20630), UINT16_C(24980) },
      { UINT16_C( 4397), UINT16_C(28276), UINT16_C(16423), UINT16_C( 2772), UINT16_C(  982), UINT16_C(11309), UINT16_C(    0), UINT16_C( 7927),
        UINT16_C(21130), UINT16_C( 4152), UINT16_C(15337), UINT16_C(14099), UINT16_C(28758), UINT16_C(33211), UINT16_C(18018), UINT16_C( 4163),
        UINT16_C(16093), UINT16_C( 3917), UINT16_C(38481), UINT16_C( 7326), UINT16_C( 2641), UINT16_C(22247), UINT16_C(53764), UINT16_C(45773),
        UINT16_C(17013), UINT16_C(  692), UINT16_C(11558), UINT16_C(29916), UINT16_C(14233), UINT16_C(44874), UINT16_C(  940), UINT16_C(19302) } },
    { { UINT16_C(60570), UINT16_C( 9842), UINT16_C(38066), UINT16_C(51790), UINT16_C(28081), UINT16_C(54057), UINT16_C(30536), UINT16_C(39100),
        UINT16_C(46543), UINT16_C(38320), UINT16_C(34623), UINT16_C(30848), UINT16_C(15317), UINT16_C(27500), UINT16_C(  139), UINT16_C( 9677),
        UINT16_C(16364), UINT16_C(40523), UINT16_C(39635), UINT16_C(33896), UINT16_C(37127), UINT16_C(20567), UINT16_C( 4872), UINT16_C(55272),
        UINT16_C(39369), UINT16_C( 2156), UINT16_C(60448), UINT16_C(63105), UINT16_C(60711), UINT16_C(45921), UINT16_C(12013), UINT16_C(55768) },
      { UINT16_C( 9325), UINT16_C(16503), UINT16_C(57278), UINT16_C(50628), UINT16_C( 7280), UINT16_C(30741), UINT16_C(65071), UINT16_C(63567),
        UINT16_C(48023), UINT16_C(46849), UINT16_C(33448), UINT16_C(53165), UINT16_C( 3951), UINT16_C(23682), UINT16_C(23357), UINT16_C(43829),
        UINT16_C(44159), UINT16_C(15851), UINT16_C(45195), UINT16_C(64258), UINT16_C( 6348), UINT16_C(64371), UINT16_C(49686), UINT16_C(44532),
        UINT16_C(62845), UINT16_C( 9572), UINT16_C( 4727), UINT16_C(59125), UINT16_C(30497), UINT16_C(24130), UINT16_C(30674), UINT16_C(20745) },
      { UINT16_C( 8618), UINT16_C( 2478), UINT16_C(33269), UINT16_C(40008), UINT16_C( 3119), UINT16_C(25356), UINT16_C(30319), UINT16_C(37925),
        UINT16_C(34105), UINT16_C(27393), UINT16_C(17670), UINT16_C(25024), UINT16_C(  923), UINT16_C( 9937), UINT16_C(   49), UINT16_C( 6471),
        UINT16_C(11026), UINT16_C( 9801), UINT16_C(27333), UINT16_C(33235), UINT16_C( 3596), UINT16_C(20201), UINT16_C( 3693), UINT16_C(37557),
        UINT16_C(37752), UINT16_C(  314), UINT16_C( 4360), UINT16_C(56931), UINT16_C(28251), UINT16_C(16907), UINT16_C( 5622), UINT16_C(17653) } },
    { { UINT16_C(62755), UINT16_C(44686), UINT16_C(37285), UINT16_C(29097), UINT16_C( 7337), UINT16_C(49004), UINT16_C(24798), UINT16_C(23404),
        UINT16_C(53333), UINT16_C(52353), UINT16_C(30434), UINT16_C(  946), UINT16_C(62701), UINT16_C(49250), UINT16_C(27499), UINT16_C(36369),
        UINT16_C(41056), UINT16_C( 1340), UINT16_C(58673), UINT16_C(55926), UINT16_C(58113), UINT16_C(57241), UINT16_C( 1347), UINT16_C(39227),
        UINT16_C(48341), UINT16_C(47205), UINT16_C( 6194), UINT16_C( 8123), UINT16_C( 7436), UINT16_C(30943), UINT16_C(61833), UINT16_C(59654) },
      { UINT16_C(17297), UINT16_C(49903), UINT16_C(25896), UINT16_C(10908), UINT16_C(13640), UINT16_C(35849), UINT16_C(17466), UINT16_C( 3877),
        UINT16_C(35328), UINT16_C(12999), UINT16_C(33698), UINT16_C(44882), UINT16_C(12704), UINT16_C(10535), UINT16_C(11554), UINT16_C(45843),
        UINT16_C(  624), UINT16_C(39285), UINT16_C( 4455), UINT16_C(45251), UINT16_C(52294), UINT16_C(32828), UINT16_C(24849), UINT16_C( 4496),
        UINT16_C(22507), UINT16_C(36420), UINT16_C(38618), UINT16_C(31549), UINT16_C(25799), UINT16_C(60068), UINT16_C(46993), UINT16_C(  669) },
      { UINT16_C(16563), UINT16_C(34026), UINT16_C(14732), UINT16_C( 4842), UINT16_C( 1527), UINT16_C(26805), UINT16_C( 6608), UINT16_C( 1384),
        UINT16_C(28749), UINT16_C(10384), UINT16_C(15648), UINT16_C(  647), UINT16_C(12154), UINT16_C( 7917), UINT16_C( 4848), UINT16_C(25440),
        UINT16_C(  390), UINT16_C(  803), UINT16_C( 3988), UINT16_C(38615), UINT16_C(46370), UINT16_C(28672), UINT16_C(  510), UINT16_C( 2691),
        UINT16_C(16601), UINT16_C(26233), UINT16_C( 3649), UINT16_C( 3910), UINT16_C( 2927), UINT16_C(28361), UINT16_C(44337), UINT16_C(  608) } },
    { { UINT16_C( 5049), UINT16_C( 8603), UINT16_C(24100), UINT16_C(27601), UINT16_C( 3370), UINT16_C(15339), UINT16_C(31598), UINT16_C(22861),
        UINT16_C(37331), UINT16_C(44519), UINT16_C( 9255), UINT16_C(60968), UINT16_C(52616), UINT16_C( 6872), UINT16_C(30340), UINT16_C(15900),
        UINT16_C(46985), UINT16_C(44383), UINT16_C(12309), UINT16_C(16152), UINT16_C( 1085), UINT16_C(43899), UINT16_C(51327), UINT16_C(20996),
        UINT16_C(60505), UINT16_C(32768), UINT16_C(10256), UINT16_C(39278), UINT16_C(18421), UINT16_C(31411), UINT16_C(53181), UINT16_C(18104) },
      { UINT16_C( 6022), UINT16_C(39923), UINT16_C( 3143), UINT16_C(34010), UINT16_C(21776), UINT16_C(36655), UINT16_C(13085), UINT16_C(30434),
        UINT16_C(57887), UINT16_C(12534), UINT16_C(25866), UINT16_C(  201), UINT16_C(31916), UINT16_C(27002), UINT16_C(12875), UINT16_C(53679),
        UINT16_C(41545), UINT16_C(36972), UINT16_C(18094), UINT16_C(48660), UINT16_C(17308), UINT16_C(47438), UINT16_C(12406), UINT16_C(38448),
        UINT16_C( 9746), UINT16_C( 7366), UINT16_C(36747), UINT16_C(14108), UINT16_C(38411), UINT16_C(22176), UINT16_C(20424), UINT16_C( 4391) },
      { UINT16_C(  463), UINT16_C( 5240), UINT16_C( 1155), UINT16_C(14323), UINT16_C( 1119), UINT16_C( 8579), UINT16_C( 6308), UINT16_C(10616),
        UINT16_C(32973), UINT16_C( 8514), UINT16_C( 3652), UINT16_C(  186), UINT16_C(25623), UINT16_C( 2831), UINT16_C( 5960), UINT16_C(13023),
        UINT16_C(29785), UINT16_C(25038), UINT16_C( 3398), UINT16_C(11992), UINT16_C(  286), UINT16_C(31776), UINT16_C( 9716), UINT16_C(12317),
        UINT16_C( 8997), UINT16_C( 3683), UINT16_C( 5750), UINT16_C( 8455), UINT16_C(10796), UINT16_C(10628), UINT16_C(16573), UINT16_C( 1212) } },
    { { UINT16_C(37874), UINT16_C(41121), UINT16_C(46553), UINT16_C(30047), UINT16_C(44536), UINT16_C(28463), UINT16_C(24541), UINT16_C(61189),
        UINT16_C(52101), UINT16_C( 4363), UINT16_C(10330), UINT16_C(25928), UINT16_C(59838), UINT16_C(34747), UINT16_C(57912), UINT16_C(10904),
        UINT16_C(14965), UINT16_C(20171), UINT16_C(10991), UINT16_C(59588), UINT16_C(62423), UINT16_C(46167), UINT16_C(23634), UINT16_C(55203),
        UINT16_C(44583), UINT16_C(33256), UINT16_C(12758), UINT16_C(38374), UINT16_C(41242), UINT16_C(21020), UINT16_C(46211), UINT16_C(63613) },
      { UINT16_C(18670), UINT16_C(56902), UINT16_C( 2674), UINT16_C(18886), UINT16_C( 7677), UINT16_C(20477), UINT16_C(41081), UINT16_C(40999),
        UINT16_C( 3918), UINT16_C( 9505), UINT16_C( 1856), UINT16_C(23226), UINT16_C(54952), UINT16_C(11181), UINT16_C(10890), UINT16_C(31011),
        UINT16_C(26994), UINT16_C(58455), UINT16_C( 7540), UINT16_C(28973), UINT16_C(10810), UINT16_C(46017), UINT16_C(59594), UINT16_C( 6227),
        UINT16_C(29943), UINT16_C(14397), UINT16_C(63355), UINT16_C( 9106), UINT16_C(16333), UINT16_C(22606), UINT16_C(29033), UINT16_C(56273) },
      { UINT16_C(10789), UINT16_C(35703), UINT16_C( 1899), UINT16_C( 8658), UINT16_C( 5217), UINT16_C( 8893), UINT16_C(15383), UINT16_C(38279),
        UINT16_C( 3114), UINT16_C(  632), UINT16_C(  292), UINT16_C( 9188), UINT16_C(50174), UINT16_C( 5928), UINT16_C( 9623), UINT16_C( 5159),
        UINT16_C( 6164), UINT16_C(17991), UINT16_C( 1264), UINT16_C(26343), UINT16_C(10296), UINT16_C(32416), UINT16_C(21491), UINT16_C( 5245),
        UINT16_C(20369), UINT16_C( 7305), UINT16_C(12333), UINT16_C( 5331), UINT16_C(10278), UINT16_C( 7250), UINT16_C(20471), UINT16_C(54621) } },
    { { UINT16_C(10458), UINT16_C(20159), UINT16_C(60485), UINT16_C(32704), UINT16_C(33046), UINT16_C(57394), UINT16_C(34153), UINT16_C(24825),
        UINT16_C(14073), UINT16_C(29848), UINT16_C(11054), UINT16_C(64407), UINT16_C(58730), UINT16_C(54355), UINT16_C( 9302), UINT16_C(12463),
        UINT16_C(28492), UINT16_C(37247), UINT16_C(16219), UINT16_C(29200), UINT16_C(17088), UINT16_C(10578), UINT16_C(19399), UINT16_C(49289),
        UINT16_C( 8834), UINT16_C(45108), UINT16_C(52045), UINT16_C(47019), UINT16_C(65456), UINT16_C( 1675), UINT16_C(15139), UINT16_C(28727) },
      { UINT16_C(46762), UINT16_C( 1281), UINT16_C( 4853), UINT16_C(46455), UINT16_C(51796), UINT16_C( 7390), UINT16_C(26389), UINT16_C(38876),
        UINT16_C( 4489), UINT16_C(54855), UINT16_C(62428), UINT16_C(36238), UINT16_C( 6642), UINT16_C( 5523), UINT16_C(51796), UINT16_C(65157),
        UINT16_C(34688), UINT16_C(29956), UINT16_C(31641), UINT16_C(60714), UINT16_C( 2117), UINT16_C(23305), UINT16_C(58992), UINT16_C(63986),
        UINT16_C(15095), UINT16_C(54224), UINT16_C(24109), UINT16_C( 8032), UINT16_C(62583), UINT16_C(52276), UINT16_C(47806), UINT16_C(16330) },
      { UINT16_C( 7462), UINT16_C(  394), UINT16_C( 4478), UINT16_C(23182), UINT16_C(26117), UINT16_C( 6471), UINT16_C(13752), UINT16_C(14726),
        UINT16_C(  963), UINT16_C(24983), UINT16_C(10529), UINT16_C(35613), UINT16_C( 5952), UINT16_C( 4580), UINT16_C( 7351), UINT16_C(12390),
        UINT16_C(15080), UINT16_C(17025), UINT16_C( 7830), UINT16_C(27051), UINT16_C(  551), UINT16_C( 3761), UINT16_C(17461), UINT16_C(48123),
        UINT16_C( 2034), UINT16_C(37322), UINT16_C(19146), UINT16_C( 5762), UINT16_C(62506), UINT16_C( 1336), UINT16_C(11043), UINT16_C( 7158) } },
    { { UINT16_C(52801), UINT16_C(55988), UINT16_C(57162), UINT16_C(36807), UINT16_C(53735), UINT16_C(22506), UINT16_C(56759), UINT16_C(44625),
        UINT16_C( 8471), UINT16_C(17537), UINT16_C(57983), UINT16_C(63075), UINT16_C(38870), UINT16_C(38082), UINT16_C(36177), UINT16_C(37587),
        UINT16_C(34907), UINT16_C(42348), UINT16_C(13415), UINT16_C(20021), UINT16_C( 7941), UINT16_C(48294), UINT16_C(63484), UINT16_C( 4970),
        UINT16_C(60184), UINT16_C(38743), UINT16_C(47821), UINT16_C(41869), UINT16_C(20562), UINT16_C(41784), UINT16_C( 3037), UINT16_C(14390) },
      { UINT16_C(41619), UINT16_C(64222), UINT16_C( 5078), UINT16_C(56137), UINT16_C(61234), UINT16_C(12183), UINT16_C(  486), UINT16_C(65090),
        UINT16_C(39661), UINT16_C(47765), UINT16_C( 8788), UINT16_C(42590), UINT16_C(38514), UINT16_C(20298), UINT16_C(32929), UINT16_C(13704),
        UINT16_C(26146), UINT16_C(63791), UINT16_C(30841), UINT16_C(43988), UINT16_C(27751), UINT16_C(19930), UINT16_C( 7533), UINT16_C(23115),
        UINT16_C(57527), UINT16_C( 2837), UINT16_C(29443), UINT16_C(30130), UINT16_C(64521), UINT16_C(43717), UINT16_C(19836), UINT16_C(40671) },
      { UINT16_C(33531), UINT16_C(54865), UINT16_C( 4429), UINT16_C(31528), UINT16_C(50207), UINT16_C( 4183), UINT16_C(  420), UINT16_C(44321),
        UINT16_C( 5126), UINT16_C(12781), UINT16_C( 7775), UINT16_C(40990), UINT16_C(22843), UINT16_C(11794), UINT16_C(18177), UINT16_C( 7859),
        UINT16_C(13926), UINT16_C(41220), UINT16_C( 6313), UINT16_C(13438), UINT16_C( 3362), UINT16_C(14686), UINT16_C( 7297), UINT16_C( 1752),
        UINT16_C(52829), UINT16_C( 1677), UINT16_C(21484), UINT16_C(19249), UINT16_C(20243), UINT16_C(27872), UINT16_C(  919), UINT16_C( 8930) } },
    { { UINT16_C( 4019), UINT16_C(11415), UINT16_C(27783), UINT16_C(61399), UINT16_C(45784), UINT16_C(17724), UINT16_C(35023), UINT16_C(34464),
        UINT16_C(46440), UINT16_C(27537), UINT16_C(17192), UINT16_C(12769), UINT16_C(42559), UINT16_C(48091), UINT16_C(48115), UINT16_C(42586),
        UINT16_C(61898), UINT16_C(20946), UINT16_C(43357), UINT16_C(13632), UINT16_C(32091), UINT16_C(10875), UINT16_C( 6917), UINT16_C(28080),
        UINT16_C(17104), UINT16_C(63705), UINT16_C(47749), UINT16_C(50473), UINT16_C( 1120), UINT16_C(21376), UINT16_C(55999), UINT16_C(35321) },
      { UINT16_C(52172), UINT16_C(10715), UINT16_C( 7028), UINT16_C(53343), UINT16_C(55960), UINT16_C(40442), UINT16_C(44021), UINT16_C(50443),
        UINT16_C(58605), UINT16_C(29373), UINT16_C(59038), UINT16_C(65079), UINT16_C(47338), UINT16_C(43601), UINT16_C(19090), UINT16_C(24115),
        UINT16_C( 3605), UINT16_C(35208), UINT16_C(59178), UINT16_C(49753), UINT16_C(21697), UINT16_C(46688), UINT16_C(27647), UINT16_C(60539),
        UINT16_C(14415), UINT16_C(60766), UINT16_C(38430), UINT16_C( 2283), UINT16_C(15438), UINT16_C(57522), UINT16_C(59014), UINT16_C(39743) },
      { UINT16_C( 3199), UINT16_C( 1866), UINT16_C( 2979), UINT16_C(49975), UINT16_C(39094), UINT16_C(10937), UINT16_C(23525), UINT16_C(26526),
        UINT16_C(41528), UINT16_C(12341), UINT16_C(15487), UINT16_C(12679), UINT16_C(30741), UINT16_C(31994), UINT16_C(14015), UINT16_C(15670),
        UINT16_C( 3404), UINT16_C(11252), UINT16_C(39150), UINT16_C(10349), UINT16_C(10624), UINT16_C( 7747), UINT16_C( 2918), UINT16_C(25938),
        UINT16_C( 3762), UINT16_C(59068), UINT16_C(27999), UINT16_C( 1758), UINT16_C(  263), UINT16_C(18762), UINT16_C(50426), UINT16_C(21419) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m512i a = simde_mm512_loadu_epi16(test_vec[i].a);
    simde__m512i b = simde_mm512_loadu_epi16(test_vec[i].b);
    simde__m512i r = simde_mm512_mulhi_epu16(a, b);
    simde_test_x86_assert_equal_u16x32(r, simde_mm512_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    simde__m512i a = simde_test_x86_random_u16x32();
    simde__m512i b = simde_test_x86_random_u16x32();
    simde__m512i r = simde_mm512_mulhi_epu16(a, b);

    simde_test_x86_write_u16x32(2, a, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_x86_write_u16x32(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_x86_write_u16x32(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

SIMDE_TEST_FUNC_LIST_BEGIN
  SIMDE_TEST_FUNC_LIST_ENTRY(mm512_mulhi_epi16)
  SIMDE_TEST_FUNC_LIST_ENTRY(mm512_mulhi_epu16)
SIMDE_TEST_FUNC_LIST_END

#include <test/x86/avx512/test-avx512-footer.h>
